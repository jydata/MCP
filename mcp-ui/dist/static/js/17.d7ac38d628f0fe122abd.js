webpackJsonp([17],{585:function(e,t,r){r(783);var n=r(307)(r(673),r(757),"data-v-97ec9644",null);n.options.__file="D:\\jiuye-pro\\jydata-git\\mcp-new\\mcp-ui\\src\\pages\\meta\\DSRules.vue",n.esModule&&Object.keys(n.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),n.options.functional&&console.error("[vue-loader] DSRules.vue: functional components are not supported with templates, they should use render functions."),e.exports=n.exports},597:function(e,t,r){"use strict";var n=r(310),a=r.n(n),u=r(599),s=r.n(u),l=r(600),i=r.n(l),o=function(){function e(){s()(this,e)}return i()(e,null,[{key:"setPromise",value:function(e,t,r){return new a.a(function(n,a){switch(e.toUpperCase()){case"GET":axios.get(t,{params:r}).then(function(e){e?n(e.data):a()});break;case"POST":case"PUT":axios({method:e,url:t,data:r}).then(function(e){e?n(e.data):a()});break;case"DELETE":axios.delete(t,{data:r}).then(function(e){e?n(e.data):a()})}})}}]),e}();t.a=o},598:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});var n="SUCCESS",a="ERROR"},599:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},600:function(e,t,r){"use strict";t.__esModule=!0;var n=r(309),a=function(e){return e&&e.__esModule?e:{default:e}}(n);t.default=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),(0,a.default)(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}()},601:function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"j",function(){return a}),r.d(t,"b",function(){return u}),r.d(t,"f",function(){return s}),r.d(t,"k",function(){return l}),r.d(t,"l",function(){return i}),r.d(t,"c",function(){return o}),r.d(t,"g",function(){return c}),r.d(t,"i",function(){return d}),r.d(t,"h",function(){return f}),r.d(t,"d",function(){return m}),r.d(t,"a",function(){return p});var n="Operation is successful！",a="Add successfully！",u="Updated successfully！",s="Deleted successfully！",l="Connection test successfully!",i="Connection test successfully!",o="Saved successfully!",c="Saved failed!",d="Synchronized successfully!",f="Transform successfully!",m="Reset password successfully！",p="Modify successfully！"},603:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(597);r.d(t,"getDSLink",function(){return a}),r.d(t,"getLoads",function(){return u}),r.d(t,"saveDSLink",function(){return s}),r.d(t,"testDSLink",function(){return l}),r.d(t,"getDBTree",function(){return i}),r.d(t,"getCount",function(){return o}),r.d(t,"getMetaTable",function(){return c}),r.d(t,"getMetaColumn",function(){return d}),r.d(t,"getTableDDL",function(){return f}),r.d(t,"getSample",function(){return m}),r.d(t,"syncRatio",function(){return p}),r.d(t,"batchSyncdata",function(){return v}),r.d(t,"getDSRoutes",function(){return b}),r.d(t,"saveRouteName",function(){return h}),r.d(t,"querySchemalists",function(){return _}),r.d(t,"saveSchemalists",function(){return x}),r.d(t,"createSchemalists",function(){return y}),r.d(t,"updateRouterStatus",function(){return w}),r.d(t,"updateRouterName",function(){return g}),r.d(t,"saveRoute",function(){return S}),r.d(t,"existTables",function(){return T}),r.d(t,"queryRoute",function(){return P}),r.d(t,"getRules",function(){return C}),r.d(t,"getRuleType",function(){return D}),r.d(t,"saveRules",function(){return R}),r.d(t,"delRules",function(){return O}),r.d(t,"queryTarget",function(){return q}),r.d(t,"getSchema",function(){return N}),r.d(t,"getRule",function(){return k}),r.d(t,"getDatabase",function(){return E}),r.d(t,"getRoutes",function(){return L}),r.d(t,"getMetadata",function(){return F}),r.d(t,"getColumns",function(){return $}),r.d(t,"getDDL",function(){return G}),r.d(t,"getBinlog",function(){return M}),r.d(t,"transformDDL",function(){return I}),r.d(t,"transformSingleDDL",function(){return j}),r.d(t,"syncDDL",function(){return A}),r.d(t,"syncSingleDDL",function(){return z}),r.d(t,"saveDDL",function(){return B});var a=function(e){return n.a.setPromise("GET","/mcp/conn/query",e)},u=function(e){return n.a.setPromise("POST","/mcp/conn/load_options",e)},s=function(e){return n.a.setPromise("POST","/mcp/conn/save",e)},l=function(e){return n.a.setPromise("POST","/mcp/conn/test",e)},i=function(e){return n.a.setPromise("POST","/mcp/sync/query_dstree",e)},o=function(e){return n.a.setPromise("POST","/mcp/sync/calc_db_info",e)},c=function(e,t){return n.a.setPromise("POST","/mcp/sync/query_table?dataList="+t,e)},d=function(e,t){return n.a.setPromise("POST","/mcp/sync/query_column?dataList="+t,e)},f=function(e,t){return n.a.setPromise("POST","/mcp/sync/load_ddl?dataList="+t,e)},m=function(e,t){return n.a.setPromise("POST","/mcp/sync/query_example?dataList="+t,e)},p=function(e,t){return n.a.setPromise("POST","/mcp/sync/sync_ratio?sourceId="+t,e)},v=function(e){return n.a.setPromise("POST","/mcp/sync/batch_sync",e)},b=function(e){return n.a.setPromise("GET","/mcp/route/query",e)},h=function(e){return n.a.setPromise("POST","/mcp/route/update_route_name",e)},_=function(e){return n.a.setPromise("POST","/mcp/route/query_schema",e)},x=function(e){return n.a.setPromise("POST","/mcp/route/save_schema",e)},y=function(e){return n.a.setPromise("POST","/mcp/route/create_schema",e)},w=function(e){return n.a.setPromise("POST","/mcp/route/update_status",e)},g=function(e){return n.a.setPromise("POST","/mcp/route/update_name",e)},S=function(e){return n.a.setPromise("POST","/mcp/route/save",e)},T=function(e){return n.a.setPromise("GET","/mcp/route/exist_table",e)},P=function(e){return n.a.setPromise("GET","/mcp/route/job_routes",e)},C=function(e){return n.a.setPromise("GET","/mcp/rule/query_list",e)},D=function(e){return n.a.setPromise("GET","/mcp/rule/query_type",e)},R=function(e){return n.a.setPromise("POST","/mcp/rule/save",e)},O=function(e){return n.a.setPromise("POST","/mcp/rule/delete",e)},q=function(e){return n.a.setPromise("GET","/mcp/ddl/query_target_info",e)},N=function(e){return n.a.setPromise("GET","/mcp/ddl/query_db_trees",e)},k=function(e){return n.a.setPromise("GET","/mcp/ddl/query_rules",e)},E=function(e){return n.a.setPromise("GET","/mcp/ddl/query_source_db",e)},L=function(e){return n.a.setPromise("GET","/mcp/ddl/query_routes",e)},F=function(e){return n.a.setPromise("GET","/mcp/ddl/query_table_meta",e)},$=function(e){return n.a.setPromise("GET","/mcp/ddl/query_columns",e)},G=function(e){return n.a.setPromise("POST","/mcp/ddl/query_ddl_info",e)},M=function(e,t,r){return n.a.setPromise("GET","/mcp/ddl/query_binlogddl_info/"+e+"/"+t+"/"+r)},I=function(e,t,r,a){return n.a.setPromise("POST","/mcp/ddl/batch_generate_sql/"+t+"/"+r+"/"+a,e)},j=function(e,t,r,a,u,s,l){return n.a.setPromise("POST","/mcp/ddl/generate_sql/"+t+"/"+r+"/"+a+"/"+u+"/"+s+"/"+l,e)},A=function(e,t){return n.a.setPromise("POST","/mcp/ddl/multi_exec_sql/"+e+"/"+t)},z=function(e,t,r,a,u,s){return n.a.setPromise("POST","/mcp/ddl/exec_sql/"+t+"/"+r+"/"+a+"/"+u+"/"+s,e)},B=function(e,t,r){return n.a.setPromise("POST","/mcp/ddl/save_sql/"+t+"/"+r,e)}},673:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(603),a=r(598),u=r(601);t.default={name:"DSRules",data:function(){var e=/^[a-zA-Z]+[\w]*$/;return{valueSlide:[0,100],isShowTable:!1,isShowColumn:!1,isShowSuffix:!1,isDetail:!0,ruleTypeList:[],ruleData:{ruleName:"",ruleType:"",rulePrefix:"",ruleColumn:"",ruleSuffix:"",dbFlag:1},ruleList:[],rule:{ruleName:[{required:!0,message:"Rule Name is required",trigger:"blur"}],ruleType:[{required:!0,message:"Rule Type is required",trigger:"blur"}],rulePrefix:[{required:!1,validator:function(t,r,n){if(r.trim().length<=0)return""===r?n():n(new Error("Spaces are not allowed"));e.test(r)?n():n(new Error("Only numbers,letters and underline are allowed, and letters must be in front"))},trigger:"blur"}],ruleColumn:[{required:!0,validator:function(t,r,n){if(""===r||r.trim().length<=0)return n(new Error("Column is required"));e.test(r)?n():n(new Error("Only numbers,letters and underline are allowed, and letters must be in front"))},trigger:"blur"}]}}},created:function(){this.getRuleType(),this.getRulesFun()},methods:{leave:function(e){e.focus=!1},changeValue:function(e){switch(e){case"Default":this.isShowColumn=!1,this.isShowTable=!1,this.isShowSuffix=!1,this.ruleData.rulePrefix="",this.ruleData.ruleColumn="";break;case"Merge table":this.isShowTable=!0,this.isShowColumn=!1,this.isShowSuffix=!1,this.ruleData.ruleColumn="";break;case"Merge table and add column":this.isShowSuffix=!1,this.isShowColumn=!0,this.isShowTable=!0;break;case"Restore":this.isShowSuffix=!0,this.isShowColumn=!1,this.isShowTable=!1}},getRulesFun:function(){var e=this;n.getRules({}).then(function(t){t.code===a.a?(e.ruleList=t.items,e.ruleList.forEach(function(t){e.$set(t,"focus",!1)})):e.$message({message:t.message,type:"error"})})},getRuleType:function(){var e=this;n.getRuleType({}).then(function(t){t.code===a.a?e.ruleTypeList=t.items:e.$message({message:t.message,type:"error"})})},saveRulesFun:function(e){var t=this;this.$refs[e].validate(function(e){if(e){var r=t.valueSlide,s={ruleName:t.ruleData.ruleName,ruleType:t.ruleData.ruleType,rulePrefix:t.ruleData.rulePrefix,ruleColumn:t.ruleData.ruleColumn,ruleSuffix:t.ruleData.ruleSuffix,dbFlag:1,beginIndex:r[0],endIndex:r[1]};if(0==s.dbFlag&&(s.beginIndex=s.endIndex=""),r[0]==r[1])return t.$message({message:"Start index is the same as end index",type:"warning"});n.saveRules(s).then(function(e){e.code===a.a?(t.$message({message:u.c,type:"success"}),t.getRulesFun(),t.ruleData={ruleName:"",ruleType:s.ruleType,rulePrefix:"",ruleColumn:"",dbFlag:"1",beginIndex:r[0],endIndex:r[1]}):t.$message({message:e.message,type:"error"})}).catch(function(){})}})},delRulesFun:function(e){var t=this;this.$confirm("Are you sure delete this rule？","Message",{confirmButtonText:"Confirm",cancelButtonText:"Cancel"}).then(function(){var r=e;n.delRules(r).then(function(e){e.code===a.a?(t.$message({message:u.f,type:"success"}),t.getRulesFun()):t.$message({message:e.message,type:"error"})})}).catch(function(){})},formatTooltip:function(e){return"Table of DBName: "+e}}}},723:function(e,t,r){t=e.exports=r(306)(),t.push([e.i,"\n.table-1[data-v-97ec9644] {\n  margin: 0;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-pack: justify;\n      justify-content: space-between;\n}\n.table-1 .el-form[data-v-97ec9644] {\n  width: 60%;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n      flex-direction: column;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  padding: 20px;\n}\n.table-1 .button[data-v-97ec9644] {\n  position: relative;\n  width: 30%;\n}\n.table-1 .button .el-button[data-v-97ec9644] {\n  position: absolute;\n  bottom: 30px;\n  right: 30px;\n}\n.el-select[data-v-97ec9644] {\n  width: 100%;\n}\n.detail-title[data-v-97ec9644] {\n  color: #888;\n  -ms-flex: 1;\n      flex: 1;\n  max-width: 136px;\n  min-width: 136px;\n  text-align: right;\n}\n.detail-ct[data-v-97ec9644] {\n  -ms-flex: 1;\n      flex: 1;\n  text-align: left;\n  display: block;\n}\n.detail[data-v-97ec9644] {\n  white-space: nowrap;\n}\n.detail li[data-v-97ec9644] {\n  display: -ms-flexbox;\n  display: flex;\n}\n.slider-rule span[data-v-97ec9644] {\n  padding: 0 5px;\n  font-size: 17px;\n}\n",""])},757:function(e,t,r){e.exports={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",[r("div",{staticClass:"header"},[r("div",{staticClass:"title"},[r("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[e._v("DS Rules")])],1)],1)]),e._v(" "),r("div",{staticClass:"container pd20"},[r("div",{staticClass:"table-1 shadow"},[r("el-form",{ref:"ruleForm",attrs:{"label-width":"180px",rules:e.rule,model:e.ruleData,"label-position":"top"}},[r("el-form-item",{attrs:{label:"Rule Name",prop:"ruleName"}},[r("el-input",{attrs:{maxlength:"20",clearable:""},model:{value:e.ruleData.ruleName,callback:function(t){e.$set(e.ruleData,"ruleName",t)},expression:"ruleData.ruleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Rule Type",prop:"ruleType"}},[r("el-select",{attrs:{filterable:"",placeholder:"Please select"},on:{change:function(t){return e.changeValue(e.ruleData.ruleType)}},model:{value:e.ruleData.ruleType,callback:function(t){e.$set(e.ruleData,"ruleType",t)},expression:"ruleData.ruleType"}},e._l(e.ruleTypeList,function(e){return r("el-option",{key:e.dictName,attrs:{label:e.dictName,value:e.dictName}})}),1)],1),e._v(" "),e.isShowTable?r("el-form-item",{attrs:{label:"Table Name Prefix",prop:"rulePrefix"}},[r("el-input",{attrs:{maxlength:"20",clearable:""},model:{value:e.ruleData.rulePrefix,callback:function(t){e.$set(e.ruleData,"rulePrefix",t)},expression:"ruleData.rulePrefix"}})],1):e._e(),e._v(" "),e.isShowSuffix?r("el-form-item",{attrs:{label:"Table Name Suffix",prop:"rulePrefix"}},[r("el-input",{attrs:{maxlength:"20",clearable:""},model:{value:e.ruleData.ruleSuffix,callback:function(t){e.$set(e.ruleData,"ruleSuffix",t)},expression:"ruleData.ruleSuffix"}})],1):e._e(),e._v(" "),e.isShowColumn?r("el-form-item",{attrs:{label:"Add Column Name",prop:"ruleColumn"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("Add Column Name "),r("span",{staticClass:"fcred"},[e._v("( SQL keyword not allowed )")])]),e._v(" "),r("el-input",{attrs:{placeholder:"Use the table database name as the value of the new column and as the union primary key",maxlength:"20",clearable:""},model:{value:e.ruleData.ruleColumn,callback:function(t){e.$set(e.ruleData,"ruleColumn",t)},expression:"ruleData.ruleColumn"}})],1):e._e(),e._v(" "),e.isShowColumn?r("el-form-item",{attrs:{label:"temp"}},[r("span",{attrs:{slot:"label"},slot:"label"},[e._v("Column Value offset "),r("span",{staticClass:"deepblue"},[e._v("( start index: "),r("span",{staticClass:"fcred fsize16"},[e._v(e._s(e.valueSlide[0]))]),e._v(", end index: "),r("span",{staticClass:"fcred fsize16"},[e._v(e._s(e.valueSlide[1]))]),e._v(" )")])]),e._v(" "),r("div",{staticClass:"flex fxmiddle slider-rule"},[r("span",{staticClass:"mr15"},[e._v("0")]),e._v(" "),r("el-slider",{staticClass:"flex1 mr15",attrs:{"show-tooltip":"true",range:"","show-tooltip":1==e.ruleData.dbFlag,"format-tooltip":e.formatTooltip,disabled:"0"==e.ruleData.dbFlag,max:100},model:{value:e.valueSlide,callback:function(t){e.valueSlide=t},expression:"valueSlide"}}),e._v(" "),r("span",[e._v("100")])],1)]):e._e()],1),e._v(" "),r("div",{staticClass:"button"},[r("el-button",{on:{click:function(t){return e.saveRulesFun("ruleForm")}}},[e._v("Save")])],1)],1),e._v(" "),r("div",{staticClass:"table-2 mt15"},[r("el-table",{staticClass:"shadow",attrs:{data:e.ruleList,"empty-text":"No data",width:"60%"}},[r("el-table-column",{attrs:{label:"#",type:"index",width:"60px"}}),e._v(" "),r("el-table-column",{attrs:{label:"Rule Name",prop:"ruleName",width:"200px"}}),e._v(" "),r("el-table-column",{attrs:{label:"Rule Type",prop:"ruleType",width:"300px"}}),e._v(" "),r("el-table-column",{attrs:{label:"Comment",prop:"comment"}}),e._v(" "),r("el-table-column",{attrs:{label:"Details",width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-popover",{attrs:{placement:"left",width:"auto",trigger:"hover","open-delay":"0"}},[r("ul",{staticClass:"detail"},[r("li",{directives:[{name:"show",rawName:"v-show",value:"Default"==t.row.ruleType||"Restore"===t.row.ruleType,expression:"scope.row.ruleType == 'Default' || scope.row.ruleType === 'Restore'"}]},[r("div",{staticClass:"detail-title"},[e._v("Rule Name：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.ruleName))])]),e._v(" "),r("li",{directives:[{name:"show",rawName:"v-show",value:t.row.rulePrefix,expression:"scope.row.rulePrefix"}]},[r("div",{staticClass:"detail-title"},[e._v("Table Name Prefix：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.rulePrefix))])]),e._v(" "),r("li",{directives:[{name:"show",rawName:"v-show",value:t.row.ruleColumn,expression:"scope.row.ruleColumn"}]},[r("div",{staticClass:"detail-title"},[e._v("Rule Column：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.ruleColumn))])]),e._v(" "),r("li",{directives:[{name:"show",rawName:"v-show",value:1==t.row.dbFlag&&"Restore"!==t.row.ruleType,expression:"scope.row.dbFlag==1 && scope.row.ruleType !== 'Restore'"}]},[r("div",{staticClass:"detail-title"},[e._v("beginIndex：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.beginIndex))])]),e._v(" "),r("li",{directives:[{name:"show",rawName:"v-show",value:1==t.row.dbFlag&&"Restore"!==t.row.ruleType,expression:"scope.row.dbFlag==1 && scope.row.ruleType !== 'Restore'"}]},[r("div",{staticClass:"detail-title"},[e._v("endIndex：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.endIndex))])]),e._v(" "),r("li",{directives:[{name:"show",rawName:"v-show",value:"Restore"===t.row.ruleType,expression:"scope.row.ruleType === 'Restore'"}]},[r("div",{staticClass:"detail-title"},[e._v("Rule Suffix：")]),e._v(" "),r("div",{staticClass:"detail-ct deepblue"},[e._v(e._s(t.row.ruleSuffix))])])]),e._v(" "),r("i",{staticClass:"detail-icon icon-file-text-o",attrs:{slot:"reference"},slot:"reference"})])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"Action",width:"70px"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"icon-trash",on:{click:function(r){return e.delRulesFun(t.row)}}})]}}])})],1)],1)])])},staticRenderFns:[]},e.exports.render._withStripped=!0},783:function(e,t,r){var n=r(723);"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);r(308)("67669046",n,!1)}});